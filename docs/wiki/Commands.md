# コマンドリファレンス

このページでは、Kuma-Reportのすべてのコマンドについて詳しく説明します。

## 目次

1. [プレイヤー向けコマンド](#プレイヤー向けコマンド)
2. [管理者向けコマンド](#管理者向けコマンド)
3. [コマンドの使用例](#コマンドの使用例)

---

## プレイヤー向けコマンド

### /report

プレイヤーを通報するコマンドです。

#### 基本情報

| 項目 | 内容 |
|------|------|
| **構文** | `/report [プレイヤー名] [理由]` |
| **エイリアス** | `/rep` |
| **権限** | `kumareport.use` |
| **クールダウン** | 設定ファイルで指定（デフォルト60秒） |

#### 使用方法

**方法1: GUI経由（推奨）**
```
/report
```

1. GUIでオンラインプレイヤーを選択
2. 通報理由のカテゴリを選択
3. 「その他」の場合はチャットで詳細を入力
4. 完了メッセージが表示される

**方法2: コマンド直接入力**
```
/report <プレイヤー名> <理由>
```

理由は5文字以上500文字以下である必要があります。

#### 使用例

```
# GUIを開く
/report

# テキストで直接通報
/report Player123 チートを使用している
/report Cheater X-Rayを使ってダイヤを採掘している

# エイリアスを使用
/rep Player456 暴言を繰り返している
```

#### 制限事項

- 自分自身を通報することはできません
- クールダウン中は再度通報できません（`kumareport.bypass.cooldown` 権限で回避可能）
- オフラインのプレイヤーは通報できません（コマンド入力の場合）

#### 出力メッセージ

**成功時:**
```
[Kuma-Report] Player123を通報しました。スタッフが確認します。
```

**エラー:**
```
# 自己通報
[Kuma-Report] 自分自身を通報することはできません。

# クールダウン中
[Kuma-Report] 通報のクールダウン中です。あと45秒お待ちください。

# プレイヤーが見つからない
[Kuma-Report] プレイヤーが見つかりません: Player999

# 理由が短すぎる/長すぎる
[Kuma-Report] 理由は5文字以上500文字以下である必要があります。
```

---

### /bugreport

サーバーのバグや不具合を報告するコマンドです。

#### 基本情報

| 項目 | 内容 |
|------|------|
| **構文** | `/bugreport [説明]` |
| **エイリアス** | `/bug`, `/breport` |
| **権限** | `kumareport.bugreport` |
| **クールダウン** | 設定ファイルで指定（デフォルト120秒） |

#### 使用方法

**方法1: GUI経由**
```
/bugreport
```

GUIが開き、チャットで説明を入力するよう促されます。

**方法2: コマンド直接入力**
```
/bugreport <説明>
```

説明は10文字以上1000文字以下である必要があります。

#### 使用例

```
# GUIを開く
/bugreport

# 直接入力
/bugreport ブロックを置くと消えてしまう
/bugreport チェストを開くとサーバーがクラッシュする
/bugreport アイテムがクラフトできない

# エイリアスを使用
/bug スポーン地点にテレポートできない
/breport コマンドブロックが動作しない
```

#### 自動記録情報

バグレポートには以下の情報が自動的に記録されます:

- 報告者名とUUID
- 報告日時
- **座標情報**（ワールド名、X, Y, Z座標）

**座標情報の例:**
```
world: X=123, Y=64, Z=-456
```

#### 出力メッセージ

**成功時:**
```
[Kuma-Report] バグレポートを送信しました。ご報告ありがとうございます。
```

**エラー:**
```
# 説明が短すぎる
[Kuma-Report] バグの説明が短すぎます。（最低10文字）

# 説明が長すぎる
[Kuma-Report] バグの説明は1000文字以下である必要があります。

# クールダウン中
[Kuma-Report] バグレポートのクールダウン中です。あと90秒お待ちください。
```

---

## 管理者向けコマンド

### /reportadmin

通報管理用のコマンドです。

#### 基本情報

| 項目 | 内容 |
|------|------|
| **構文** | `/reportadmin [サブコマンド]` |
| **エイリアス** | `/radmin`, `/ra` |
| **権限** | `kumareport.admin` |

#### サブコマンド一覧

| サブコマンド | 説明 |
|------------|------|
| `（なし）` | 管理GUIを開く（Java版のみ） |
| `list [ページ]` | 通報一覧を表示 |
| `view <ID>` | 通報詳細を表示 |
| `accept <ID> [メモ]` | 通報を承認 |
| `deny <ID> [メモ]` | 通報を却下 |
| `search <プレイヤー名>` | プレイヤーの通報を検索 |
| `stats` | 統計情報を表示 |
| `reload` | 設定をリロード |
| `gui` | 管理GUIを開く |

---

### /reportadmin（引数なし）

管理者向けGUIを開きます。

#### 使用方法

```
/reportadmin
```

#### 出力

Java版プレイヤーの場合、GUIが開きます。
コンソールから実行した場合は使用方法が表示されます。

---

### /reportadmin list

通報一覧を表示します。

#### 構文

```
/reportadmin list [ページ番号]
```

#### 使用例

```
# 1ページ目を表示
/reportadmin list

# 2ページ目を表示
/reportadmin list 2

# エイリアスを使用
/radmin list
/ra list 3
```

#### 出力例

```
===== 通報一覧 (ページ 1/3) =====
#1 - PlayerA → PlayerB (未処理)
#2 - PlayerC → PlayerD (承認)
#3 - PlayerE → PlayerF (未処理)
...
次のページ: /reportadmin list 2
```

#### ページネーション

- 1ページあたりの表示数は `config.yml` の `gui.items-per-page` で設定
- デフォルトは45件
- ページ番号が範囲外の場合はエラーメッセージを表示

---

### /reportadmin view

通報の詳細情報を表示します。

#### 構文

```
/reportadmin view <通報ID>
```

#### 使用例

```
/reportadmin view 1
/radmin view 42
/ra view 100
```

#### 出力例

```
===== 通報詳細 #1 =====
通報者: PlayerA
被通報者: PlayerB
理由: チート使用
種類: CHEAT
ステータス: 未処理
日時: 2025-12-27 14:30:00
========================
```

**処理済みの場合:**
```
===== 通報詳細 #1 =====
通報者: PlayerA
被通報者: PlayerB
理由: チート使用
種類: CHEAT
ステータス: 承認
日時: 2025-12-27 14:30:00
処理者: AdminUser
処理日時: 2025-12-27 15:00:00
処理メモ: 3日間のBANを実施
========================
```

---

### /reportadmin accept

通報を承認します。

#### 構文

```
/reportadmin accept <通報ID> [メモ]
```

#### 使用例

```
# メモなし
/reportadmin accept 1

# メモ付き
/reportadmin accept 1 3日間のBANを実施
/radmin accept 42 証拠確認済み、警告を送信
/ra accept 100 チート使用を確認、永久BAN
```

#### 動作

1. 通報のステータスを「承認済み」に変更
2. 処理者名・処理日時を記録
3. メモがある場合は記録
4. 通報者に承認通知を送信

#### 出力メッセージ

**成功時:**
```
[Kuma-Report] 通報 #1 を承認しました。
```

**エラー:**
```
# 通報が見つからない
[Kuma-Report] 通報が見つかりません: #999

# 既に処理済み
[Kuma-Report] この通報は既に処理されています。
```

#### 通報者への通知

通報者がオンラインの場合、以下のメッセージが送信されます:
```
[Kuma-Report] あなたの通報が承認されました。（通報ID: #1）
```

---

### /reportadmin deny

通報を却下します。

#### 構文

```
/reportadmin deny <通報ID> [メモ]
```

#### 使用例

```
# メモなし
/reportadmin deny 1

# メモ付き
/reportadmin deny 1 証拠不十分のため却下
/radmin deny 42 誤通報と判断
/ra deny 100 既に他の管理者が対応済み
```

#### 動作

1. 通報のステータスを「却下済み」に変更
2. 処理者名・処理日時を記録
3. メモがある場合は記録
4. 通報者に却下通知を送信

#### 出力メッセージ

**成功時:**
```
[Kuma-Report] 通報 #1 を却下しました。
```

**エラー:**
```
# 通報が見つからない
[Kuma-Report] 通報が見つかりません: #999

# 既に処理済み
[Kuma-Report] この通報は既に処理されています。
```

#### 通報者への通知

通報者がオンラインの場合、以下のメッセージが送信されます:
```
[Kuma-Report] あなたの通報が却下されました。（通報ID: #1）
```

---

### /reportadmin search

特定のプレイヤーに関する通報を検索します。

#### 構文

```
/reportadmin search <プレイヤー名>
```

#### 使用例

```
/reportadmin search PlayerB
/radmin search Cheater123
/ra search BadPlayer
```

#### 出力例

```
===== PlayerB の通報履歴 =====
(機能は準備中です)
```

**注意:** 現在この機能は開発中です。将来のバージョンで実装予定です。

---

### /reportadmin stats

通報の統計情報を表示します。

#### 構文

```
/reportadmin stats
```

#### 使用例

```
/reportadmin stats
/radmin stats
/ra stats
```

#### 出力例

```
===== 通報統計 =====
総通報数: 150
未処理: 12
承認済み: 120
却下済み: 18
===============
```

#### 統計項目

| 項目 | 説明 |
|------|------|
| **総通報数** | すべての通報の合計 |
| **未処理** | まだ処理されていない通報 |
| **承認済み** | 承認された通報 |
| **却下済み** | 却下された通報 |

---

### /reportadmin reload

設定ファイルとメッセージファイルを再読み込みします。

#### 構文

```
/reportadmin reload
```

#### 使用例

```
/reportadmin reload
/radmin reload
/ra reload
```

#### リロード対象

- `config.yml` - メイン設定ファイル
- `messages.yml` - メッセージ設定ファイル

#### 出力メッセージ

```
[Kuma-Report] 設定ファイルをリロードしました。
```

#### 注意事項

- サーバーを再起動する必要はありません
- データベース接続は再読み込みされません
- オンラインプレイヤーには影響ありません

---

### /reportadmin gui

管理者向けGUIを開きます。

#### 構文

```
/reportadmin gui
```

#### 使用例

```
/reportadmin gui
/radmin gui
/ra gui
```

#### 出力

Java版プレイヤーの場合、管理GUIが開きます。
コンソールから実行した場合はエラーメッセージが表示されます。

---

## コマンドの使用例

### シナリオ1: プレイヤーがチートを報告

**プレイヤーの操作:**
```
/report Cheater123 X-Rayを使用している
```

**出力:**
```
[Kuma-Report] Cheater123を通報しました。スタッフが確認します。
```

**スタッフへの通知:**
```
[Kuma-Report] 新しい通報が届きました
ID: #1 | 通報者: PlayerA | 被通報者: Cheater123
理由: X-Rayを使用している
確認: /reportadmin view 1
```

---

### シナリオ2: 管理者が通報を処理

**管理者の操作:**
```
# 通報一覧を確認
/reportadmin list

# 詳細を確認
/reportadmin view 1

# 通報を承認
/reportadmin accept 1 証拠確認済み、3日間のBANを実施
```

**出力:**
```
[Kuma-Report] 通報 #1 を承認しました。
```

**通報者への通知:**
```
[Kuma-Report] あなたの通報が承認されました。（通報ID: #1）
```

---

### シナリオ3: バグを報告

**プレイヤーの操作:**
```
/bugreport チェストを開くとアイテムが消える
```

**出力:**
```
[Kuma-Report] バグレポートを送信しました。ご報告ありがとうございます。
```

**スタッフへの通知:**
```
[Kuma-Report] 新しいバグレポートが届きました
ID: #1 | 報告者: PlayerB
説明: チェストを開くとアイテムが消える
場所: world: X=123, Y=64, Z=-456
```

---

### シナリオ4: 統計情報の確認

**管理者の操作:**
```
/reportadmin stats
```

**出力:**
```
===== 通報統計 =====
総通報数: 150
未処理: 12
承認済み: 120
却下済み: 18
===============
```

---

### シナリオ5: 設定の変更とリロード

**管理者の操作:**
```
# 1. config.ymlを編集（クールダウンを変更）

# 2. 設定をリロード
/reportadmin reload
```

**出力:**
```
[Kuma-Report] 設定ファイルをリロードしました。
```

---

## タブ補完

すべてのコマンドでタブ補完が利用できます。

### /report

```
/report <Tab>          # オンラインプレイヤー名が表示される
/report Player123 <Tab> # 理由の例が表示される（GUI推奨）
```

### /bugreport

```
/bugreport <Tab>       # バグの説明例が表示される
```

### /reportadmin

```
/reportadmin <Tab>     # サブコマンド一覧が表示される
/reportadmin list <Tab> # ページ番号の候補が表示される
/reportadmin view <Tab> # 通報ID（表示されません）
```

---

## 権限による制限

各コマンドは権限によって制限されます。詳細は [権限設定](Permissions.md) を参照してください。

| コマンド | 必要な権限 |
|---------|-----------|
| `/report` | `kumareport.use` |
| `/bugreport` | `kumareport.bugreport` |
| `/reportadmin` | `kumareport.admin` |

---

前のページ: [設定ファイル詳細](Configuration.md) | 次のページ: [権限設定](Permissions.md)
